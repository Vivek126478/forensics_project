<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Asteroid Game</title>
    <style>
        body { margin: 0; padding: 0; background: #000; color: #0f0; font-family: monospace; }
        canvas { display: block; margin: 0 auto; border: 2px solid #0f0; }
        .info { text-align: center; margin: 10px; }
        .bug { color: #f00; }
    </style>
</head>
<body>
    <div class="info">
        <h2>Asteroid Game</h2>
        <div>Score: <span id="score">0</span> | Lives: <span id="lives">3</span></div>
        <div>Use WASD or Arrow Keys to move, SPACE to shoot</div>
        <div class="bug">BUGS: Ship rotates wrong direction, bullets disappear immediately, asteroids move backwards</div>
    </div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Game state
        let score = 0;
        let lives = 3;
        let gameRunning = true;
        
        // Player ship
        const ship = {
            x: 400,
            y: 300,
            angle: 0,
            velocity: { x: 0, y: 0 },
            speed: 0.2,
            maxSpeed: 5,
            size: 10
        };
        
        // Bullets
        const bullets = [];
        const bulletSpeed = 8;
        const bulletLifetime = 60; // frames
        
        // Asteroids
        const asteroids = [];
        const asteroidCount = 5;
        
        // Initialize asteroids
        function initAsteroids() {
            asteroids.length = 0;
            for (let i = 0; i < asteroidCount; i++) {
                asteroids.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    velocity: {
                        x: (Math.random() - 0.5) * 2,
                        y: (Math.random() - 0.5) * 2
                    },
                    size: 30 + Math.random() * 20,
                    angle: 0,
                    rotationSpeed: (Math.random() - 0.5) * 0.1
                });
            }
        }
        
        // BUG 1: Ship rotation is inverted
        function rotateShip(direction) {
            // BUG: Rotation goes wrong direction
            ship.angle += direction * 0.1;  // Should be -= direction * 0.1
        }
        
        function accelerateShip() {
            const forceX = Math.cos(ship.angle) * ship.speed;
            const forceY = Math.sin(ship.angle) * ship.speed;
            
            ship.velocity.x += forceX;
            ship.velocity.y += forceY;
            
            // Limit speed
            const speed = Math.sqrt(ship.velocity.x * ship.velocity.x + ship.velocity.y * ship.velocity.y);
            if (speed > ship.maxSpeed) {
                ship.velocity.x = (ship.velocity.x / speed) * ship.maxSpeed;
                ship.velocity.y = (ship.velocity.y / speed) * ship.maxSpeed;
            }
        }
        
        function updateShip() {
            ship.x += ship.velocity.x;
            ship.y += ship.velocity.y;
            
            // Wrap around screen
            if (ship.x < 0) ship.x = canvas.width;
            if (ship.x > canvas.width) ship.x = 0;
            if (ship.y < 0) ship.y = canvas.height;
            if (ship.y > canvas.height) ship.y = 0;
        }
        
        // BUG 2: Bullets disappear immediately
        function shoot() {
            bullets.push({
                x: ship.x,
                y: ship.y,
                velocity: {
                    x: Math.cos(ship.angle) * bulletSpeed,
                    y: Math.sin(ship.angle) * bulletSpeed
                },
                lifetime: bulletLifetime
            });
        }
        
        function updateBullets() {
            for (let i = bullets.length - 1; i >= 0; i--) {
                const bullet = bullets[i];
                
                // BUG: Bullets disappear immediately instead of after lifetime
                if (bullet.lifetime > 0) {  // Should be bullet.lifetime <= 0
                    bullets.splice(i, 1);
                    continue;
                }
                
                bullet.x += bullet.velocity.x;
                bullet.y += bullet.velocity.y;
                bullet.lifetime--;
                
                // Wrap around screen
                if (bullet.x < 0) bullet.x = canvas.width;
                if (bullet.x > canvas.width) bullet.x = 0;
                if (bullet.y < 0) bullet.y = canvas.height;
                if (bullet.y > canvas.height) bullet.y = 0;
            }
        }
        
        // BUG 3: Asteroids move backwards
        function updateAsteroids() {
            asteroids.forEach(asteroid => {
                // BUG: Asteroids move backwards
                asteroid.x -= asteroid.velocity.x;  // Should be +=
                asteroid.y -= asteroid.velocity.y;  // Should be +=
                asteroid.angle += asteroid.rotationSpeed;
                
                // Wrap around screen
                if (asteroid.x < -asteroid.size) asteroid.x = canvas.width + asteroid.size;
                if (asteroid.x > canvas.width + asteroid.size) asteroid.x = -asteroid.size;
                if (asteroid.y < -asteroid.size) asteroid.y = canvas.height + asteroid.size;
                if (asteroid.y > canvas.height + asteroid.size) asteroid.y = -asteroid.size;
            });
        }
        
        function checkCollisions() {
            // Bullet vs Asteroid collisions
            for (let i = bullets.length - 1; i >= 0; i--) {
                const bullet = bullets[i];
                
                for (let j = asteroids.length - 1; j >= 0; j--) {
                    const asteroid = asteroids[j];
                    
                    const dx = bullet.x - asteroid.x;
                    const dy = bullet.y - asteroid.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < asteroid.size) {
                        // Hit!
                        bullets.splice(i, 1);
                        asteroids.splice(j, 1);
                        score += 100;
                        
                        // Create smaller asteroids if large enough
                        if (asteroid.size > 20) {
                            for (let k = 0; k < 2; k++) {
                                asteroids.push({
                                    x: asteroid.x,
                                    y: asteroid.y,
                                    velocity: {
                                        x: (Math.random() - 0.5) * 3,
                                        y: (Math.random() - 0.5) * 3
                                    },
                                    size: asteroid.size * 0.6,
                                    angle: 0,
                                    rotationSpeed: (Math.random() - 0.5) * 0.1
                                });
                            }
                        }
                        break;
                    }
                }
            }
            
            // Ship vs Asteroid collisions
            asteroids.forEach(asteroid => {
                const dx = ship.x - asteroid.x;
                const dy = ship.y - asteroid.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < asteroid.size + ship.size) {
                    lives--;
                    if (lives <= 0) {
                        gameRunning = false;
                    } else {
                        // Reset ship position
                        ship.x = 400;
                        ship.y = 300;
                        ship.velocity.x = 0;
                        ship.velocity.y = 0;
                    }
                }
            });
        }
        
        function drawShip() {
            ctx.save();
            ctx.translate(ship.x, ship.y);
            ctx.rotate(ship.angle);
            
            ctx.strokeStyle = '#0f0';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(ship.size, 0);
            ctx.lineTo(-ship.size, -ship.size/2);
            ctx.lineTo(-ship.size/2, 0);
            ctx.lineTo(-ship.size, ship.size/2);
            ctx.closePath();
            ctx.stroke();
            
            ctx.restore();
        }
        
        function drawBullets() {
            ctx.fillStyle = '#ff0';
            bullets.forEach(bullet => {
                ctx.beginPath();
                ctx.arc(bullet.x, bullet.y, 2, 0, Math.PI * 2);
                ctx.fill();
            });
        }
        
        function drawAsteroids() {
            ctx.strokeStyle = '#0f0';
            ctx.lineWidth = 2;
            
            asteroids.forEach(asteroid => {
                ctx.save();
                ctx.translate(asteroid.x, asteroid.y);
                ctx.rotate(asteroid.angle);
                
                ctx.beginPath();
                for (let i = 0; i < 8; i++) {
                    const angle = (i / 8) * Math.PI * 2;
                    const radius = asteroid.size + Math.sin(angle * 3) * 5;
                    const x = Math.cos(angle) * radius;
                    const y = Math.sin(angle) * radius;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.closePath();
                ctx.stroke();
                
                ctx.restore();
            });
        }
        
        function draw() {
            // Clear canvas
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            drawShip();
            drawBullets();
            drawAsteroids();
            
            // Update UI
            document.getElementById('score').textContent = score;
            document.getElementById('lives').textContent = lives;
        }
        
        function gameLoop() {
            if (!gameRunning) {
                ctx.fillStyle = '#f00';
                ctx.font = '48px monospace';
                ctx.textAlign = 'center';
                ctx.fillText('GAME OVER', canvas.width / 2, canvas.height / 2);
                return;
            }
            
            updateShip();
            updateBullets();
            updateAsteroids();
            checkCollisions();
            draw();
            
            requestAnimationFrame(gameLoop);
        }
        
        // Input handling
        const keys = {};
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });
        
        function handleInput() {
            if (keys['a'] || keys['arrowleft']) rotateShip(-1);
            if (keys['d'] || keys['arrowright']) rotateShip(1);
            if (keys['w'] || keys['arrowup']) accelerateShip();
            if (keys[' ']) {
                if (bullets.length < 10) { // Limit bullets
                    shoot();
                }
            }
        }
        
        // Start game
        initAsteroids();
        setInterval(handleInput, 16); // ~60 FPS
        gameLoop();
    </script>
</body>
</html>



